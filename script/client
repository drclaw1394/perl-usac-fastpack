#!/usr/bin/env/ usac --backend AnyEvent
#

use v5.36;
use Data::Dumper;
use uSAC::IO;
use uSAC::FastPack::Broker;
use uSAC::FastPack::Broker::Bridge;

my $node=uSAC::FastPack::Broker->new;

my %config;



say STDERR "DO CONNECT";
my $c="po=6123,t=stream,f=INET\$,i=lo";
$node->connect($c, sub {
    if($_[0]){
      say STDERR "CONNECTED OK";
      $node->listen(undef, "test", sub {
          say STDERR "GOT MESSAGE ".Dumper @_;
        });
    }
});



uSAC::IO::timer 0, 1, sub {
  #$node->broadcast(undef, "test", "value");
};



1;
